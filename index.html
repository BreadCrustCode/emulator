<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Emulator448</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: #020617;
  overflow: hidden;
  cursor: pointer; /* optional: indicate user can click */
}
#game { width: 100vw; height: 100vh; background: #000; }
</style>
</head>
<body>

<input type="file" id="romInput" accept=".nes,.smc,.sfc,.gba,.gbc,.gb,.n64,.z64,.v64,.nds,.3ds,.cia,.iso,.bin,.cue,.gen,.smd,.zip,.img,.exe,.cso,.pkg" style="display:all;">
<div id="game"></div>

<script>
const romInput = document.getElementById('romInput');
const gameDiv = document.getElementById('game');

const coreMap = {
  '.nes': 'nes', '.smc': 'snes', '.sfc': 'snes', '.gba': 'gba',
  '.gbc': 'gbc', '.gb': 'gb', '.n64': 'n64', '.z64': 'n64', '.v64': 'n64',
  '.nds': 'nds', '.3ds': '3ds', '.cia': '3ds', '.iso': 'ps1',
  '.bin': 'ps1', '.cue': 'ps1', '.gen': 'genesis', '.smd': 'genesis',
  '.zip': 'mame', '.img': 'dos', '.exe': 'dos', '.cso': 'psp', '.pkg': 'ps3'
};

// Auto trigger file picker on first click anywhere
document.body.addEventListener('click', () => romInput.click(), { once: true });

romInput.addEventListener('change', () => {
  const rom = romInput.files[0];
  if (!rom) return;

  const core = coreMap[rom.name.slice(rom.name.lastIndexOf('.')).toLowerCase()];
  if (!core) return alert("Unsupported ROM: " + rom.name);

  const romURL = URL.createObjectURL(rom);

  window.EJS_player = "#game";
  window.EJS_core = core;
  window.EJS_gameUrl = romURL;
  window.EJS_pathtodata = "https://cdn.emulatorjs.org/stable/data/";

  const existing = document.getElementById('emulatorJS');
  if (existing) existing.remove();

  const script = document.createElement('script');
  script.id = 'emulatorJS';
  script.src = "https://cdn.emulatorjs.org/stable/data/loader.js";
  script.onload = () => {
    // Auto fullscreen
    if (gameDiv.requestFullscreen) gameDiv.requestFullscreen();
    else if (gameDiv.webkitRequestFullscreen) gameDiv.webkitRequestFullscreen();
  };
  document.body.appendChild(script);
});
</script>

</body>
</html>
